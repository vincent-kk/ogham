#!/usr/bin/env node
import{resolve as u}from"node:path";import{existsSync as l}from"node:fs";import{join as p}from"node:path";var s=".maencof-meta",a=".maencof";function d(t){return l(p(t,a))||l(p(t,s))}async function h(){let t=[];for await(let e of process.stdin)t.push(e);return Buffer.concat(t).toString("utf-8")}function g(t){process.stdout.write(JSON.stringify(t))}var m=[a,s];function x(t,e){let n=u(t,e),r=t.endsWith("/")?t:t+"/";if(!n.startsWith(r)&&n!==t)return!1;let o=n.slice(r.length);for(let i of m)if(o.startsWith(i+"/")||o===i)return!1;return!!n.endsWith(".md")}var _={Read:"maencof_read",Grep:"kg_search",Glob:"kg_search or kg_navigate"};function P(t,e){let n=u(t,e),r=t.endsWith("/")?t:t+"/";if(n!==t&&!n.startsWith(r))return!1;if(n!==t){let o=n.slice(r.length);for(let i of m)if(o.startsWith(i+"/")||o===i)return!1}return!0}function R(t){let e=t.cwd??process.cwd();if(!d(e))return{continue:!0};let n=t.tool_name??"";if(n==="Glob")return S(e,t.tool_input);let r=t.tool_input?.file_path??t.tool_input?.path??"";if(!r)return{continue:!0};if(!x(e,r))return{continue:!0};let o=_[n]??"maencof MCP tools",i=e.endsWith("/")?e:e+"/",f=u(e,r).slice(i.length);return{continue:!0,hookSpecificOutput:{additionalContext:[`[maencof] Use ${o} instead of ${n} for vault documents.`,`Path: ${f} \u2192 ${o}(path: "${f}")`].join(`
`)}}}function S(t,e){let n=e?.pattern??"",r=e?.path??t;if(!n.includes(".md"))return{continue:!0};if(!P(t,r))return{continue:!0};let o=_.Glob??"maencof MCP tools";return{continue:!0,hookSpecificOutput:{additionalContext:[`[maencof] Use ${o} instead of Glob for vault documents.`,`Pattern: ${n} \u2192 ${o}`].join(`
`)}}}var C=await h(),c;try{let t=JSON.parse(C);c=R(t)}catch{c={continue:!0}}g(c);
