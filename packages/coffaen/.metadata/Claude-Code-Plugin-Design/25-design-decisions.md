---
created: 2026-02-28
updated: 2026-02-28
tags: [design-decisions, adr, algorithm-priority, wal]
layer: design-area-6
---

# 설계 결정 — 7개 핵심 ADR + 알고리즘 우선순위 큐

## 개요

연구 보고서 알고리즘을 실용 도구로 전환하면서의 핵심 결정 7개와 구현 우선순위.

관련 문서: [설계 원칙](./01-design-principles.md) | [확산 활성화](./10-spreading-activation.md) | [크래시 복구](./15-crash-recovery.md)

---

## 핵심 결정 요약

| # | 결정 | 채택안 | 핵심 근거 |
|---|------|--------|----------|
| 1 | 데이터 모델 입도 | 페이지 중심 | 100줄 문서 = 청크, 그래프 복잡도 최소화 |
| 2 | 그래프 저장 | 인메모리+JSON | 외부 의존성 제로, 디버깅 가능, 재빌드 가능 |
| 3 | 순환 처리 | smartAE | 양방향 참조 보존, 에너지 무한 증폭 방지 |
| 4 | 검색 모델 | SA 우선 | 맥락 종속적 발산 탐색이 핵심 가치 |
| 5 | LLM 의존성 | Phase 2까지 free | 오프라인 보장, 비용 이중 발생 방지 |
| 6 | 대상 저장소 | 4-Layer 특수 최적화 | Layer 감쇠 인자, 문서=청크 최적화 기회 |
| 7 | 영속성 보장 | WAL 기반 복구 | 다단계 파일 조작의 원자성 보장 |

---

## 알고리즘 우선순위 큐

| 우선순위 | 알고리즘 | 난이도 | 외부 의존 | Phase |
|---------|---------|--------|----------|-------|
| P0 | 디렉토리 트리 파싱 | 낮음 | 없음 | 1 |
| P0 | 링크 그래프 구축 | 낮음 | 없음 | 1 |
| P0 | Frontmatter 파싱 | 낮음 | 없음 | 1 |
| P0 | 증분 변경 감지 | 낮음 | 없음 | 1 |
| P0 | DFS + DAG 변환 | 중간 | 없음 | 1 |
| P0 | 확산 활성화 엔진 | 중간 | 없음 | 1 |
| P1 | Wu-Palmer 유사도 | 낮음 | 없음 | 2 |
| P1 | SCS, PageRank | 중간 | 없음 | 2 |
| P1 | 규칙 기반 키워드 | 낮음 | 없음 | 2 |
| P2 | 커뮤니티 탐지 | 높음 | 가능 | 2+ |
| P2 | 벡터 임베딩 | 높음 | 필수 | 3 |
| P3 | LLM 트리플/요약 | 매우 높음 | 필수 | 3 |

**원칙**: P0→P1→P2→P3 순서. P0만으로 릴리즈 가능한 MVP.

---

## ADR #7 — WAL 기반 영속성 보장 (신규)

**결정**: 기억 전이 등 다단계 파일 조작에 WAL을 적용한다.
**근거**: 인덱스는 재빌드 가능하지만, 원본 마크다운의 이동/삭제는 비가역적이다.
**트레이드오프**: WAL 파일 관리 오버헤드. SessionStart에서 잔존 WAL 복구 필요.
상세: [크래시 복구](./15-crash-recovery.md)
