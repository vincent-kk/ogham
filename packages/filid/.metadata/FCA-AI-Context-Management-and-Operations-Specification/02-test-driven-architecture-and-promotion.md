## **2\. 테스트 주도 아키텍처와 3+12 규칙에 따른 승격(Promotion) 로직**

에이전트가 자율적으로 코드베이스를 진화시키기 위해서는 인간의 직관을 대체할 수 있는 정량적이고 수학적인 구조 통제 알고리즘이 필요하다. FCA-AI 아키텍처는 이를 위해 테스트 코드를 기능 검증 도구에서 아키텍처 복잡도 측정 및 상태 제어 도구로 격상시켰다. 이 체계 내에서 ./\_\_tests\_\_ 디렉토리 내의 파일은 목적에 따라 명세 테스트인 .spec.ts와 회귀 및 QA 테스트인 .test.ts로 엄격하게 분리된다.1

### **2.1. 복잡도 한계 통제를 위한 3+12 규칙**

특정 컴포넌트가 무한정 비대해지는 것을 방지하기 위해, 모든 .spec.ts 파일은 '3+12 규칙(3+12 Rule)'이라는 구조적 하드 리밋(Hard Limit)을 적용받는다.1 이는 하나의 명세 파일 내에 핵심 동작을 정의하는 3개의 기본 테스트와 엣지 케이스를 검증하는 최대 12개의 복잡한 테스트, 즉 총 15개의 테스트 케이스만을 허용하는 임계값이다.1

이 15개의 임계값을 초과하는 순간, 에이전트는 해당 프랙탈이 단일 책임 원칙(Single Responsibility Principle, SRP)을 명백히 위배하여 과도한 복잡성을 띄게 되었다고 판단하고 아키텍처 개입 파이프라인을 가동한다.1 이때 에이전트가 직면하는 문제는 해당 컴포넌트의 내부 로직을 재배치하는 '압축(Compression)'을 수행할 것인지, 아니면 완전히 독립된 하위 프랙탈로 쪼개는 '분할(Splitting)'을 수행할 것인지를 결정하는 것이다.1

이 결정은 두 가지 정량적 소프트웨어 공학 지표를 통해 자율적으로 이루어진다. 첫째, 에이전트는 해당 모듈의 AST를 분석하여 의존성 그래프를 그리고, '메소드 응집도 결여(Lack of Cohesion of Methods, LCOM4)' 지표를 계산한다.1 서로 데이터나 로직을 공유하지 않는 분절된 덩어리가 존재하여 LCOM4 값이 2 이상으로 도출될 경우, 이는 이질적 로직의 혼재를 의미하므로 에이전트는 무조건 클래스 추출을 통한 '신규 하위 프랙탈 창출(Splitting)'을 지시한다.1 반대로 LCOM4 값이 1을 유지하여 응집도는 높지만, '순환 복잡도(Cyclomatic Complexity, CC)'가 15를 초과하는 경우에는 제어 흐름이 지나치게 꼬인 상태이므로 '메서드 추출'이나 다형성(Polymorphism)을 적용하는 '로직 압축(Compression)'을 수행한다.1

### **2.2. 회귀 테스트(.test.ts)의 수명 주기와 승격(Promotion) 알고리즘**

테스트 주도 개발(TDD) 기반의 에이전트 워크플로우에서 버그 픽스나 새로운 요구사항이 발생하면 에이전트는 반드시 실패하는 테스트를 먼저 작성(Red 단계)하고, 이를 통과하는 코드를 구현(Green 단계)한 뒤 리팩토링하는 사이클을 거친다.12 이 과정에서 발견된 결함이나 특정 엣지 케이스를 방어하기 위한 임시 코드들은 모두 .test.ts (회귀 테스트) 파일에 저장된다.1

그러나 방대한 회귀 테스트가 영구적으로 보존되면 에이전트의 구문 분석 토큰을 낭비하고 빌드 파이프라인의 속도를 저하시킨다. 이를 해결하기 위해 에이전트 시스템은 '테스트 승격(Promotion)'이라는 수명 주기 관리 알고리즘을 백그라운드에서 실행한다.1 에이전트는 특정 .test.ts 파일이 3개월 등 사전 정의된 안정화 기간 동안 단 한 번의 실패 없이 회귀 검증을 통과하는지 모니터링한다.1 안정성이 수학적으로 증명된 테스트는 일회성 방어 코드가 아니라 모듈의 근본적인 성질로 인정된다. 이때 에이전트는 중복되는 여러 회귀 테스트 케이스들을 데이터 주도형(Data-driven)의 파라미터화(Parameterized)된 단일 테스트로 압축하고, 이를 .spec.ts 문서로 이관(승격)시킨 뒤 원본 .test.ts 파일을 코드베이스에서 완전히 삭제한다.1 이 동적인 정리 작업은 테스트 스위트의 품질을 극대화하고 에이전트가 참조해야 할 컨텍스트 부하를 최소화한다.

#### 참고 자료

1. FCA-AI 아키텍처 심층 리서치 및 해결 방안
12. A Guide to Test-Driven Development (TDD) with Real-World Examples \- Medium, 2월 21, 2026에 액세스, [https://medium.com/@dees3g/a-guide-to-test-driven-development-tdd-with-real-world-examples-d92f7c801607](https://medium.com/@dees3g/a-guide-to-test-driven-development-tdd-with-real-world-examples-d92f7c801607)
