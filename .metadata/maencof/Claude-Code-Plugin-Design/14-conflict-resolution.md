---
created: 2026-02-28
updated: 2026-02-28
tags: [conflict-resolution, deduplication, merge, consistency]
layer: design-area-3
---

# 충돌 해소 — 중복 방지, 병합/갱신/충돌 전략

## 목적

새 문서 생성 시 기존 문서와의 중복을 탐지하고,
충돌 유형별로 최적 경로를 선택하는 규칙을 정한다.

관련 문서: [원자적 문서 정책](./04-atomic-document-policy.md) | [Frontmatter 스키마](./05-frontmatter-schema.md) | [링크 정책](./06-link-policy.md)

---

## 1. 중복 감지

### 1차: Frontmatter `tags` Jaccard 유사도
- Jaccard = |교집합| / |합집합|. 임계값 ≥ 0.5 → 중복 후보

### 2차: 제목 + 첫 문단 키워드 매칭
- 1차 통과 문서에 한해 수행

### 선택적 확장: 벡터 임베딩
- 기본 배제 (NO-GO). 인터페이스만 정의

---

## 2. 해소 전략

| 전략 | 설명 | 적용 조건 |
|------|------|----------|
| 병합 | 두 문서 통합. 100줄 초과 시 분할 | 동일 Layer + 높은 유사도 |
| 갱신 | 기존 문서에 새 정보 추가 | 기존이 더 완성도 높을 때 |
| 링크 전환 | 중복 대신 기존 문서로 링크 | 다른 Layer + 동일 개념 |
| 사용자 판단 | 자동 결정 불가 시 위임 | 애매한 유사도 |

---

## 3. 의사결정 트리

```
새 문서 생성 요청
  → 1차 Jaccard 계산
  ├─ < 0.3 → 중복 없음, 생성
  ├─ 0.3~0.5 → 2차 키워드 매칭
  │     ├─ 낮음 → 생성
  │     └─ 높음 → 충돌 분류
  └─ ≥ 0.5 → 충돌 분류
        ├─ 동일 태그 + 동일 Layer → 병합
        ├─ 동일 태그 + 다른 Layer → 링크
        └─ 다른 태그 + 유사 내용 → 사용자 판단
```

---

## 4. Autonomy Level별 충돌 해소

| 상황 | Level 0 | Level 1 | Level 2 | Level 3 |
|------|---------|---------|---------|---------|
| 중복 탐지 | 사용자 판단 | 전략 제안 | 자동 실행 | 자동 실행 |
| 병합 실행 | 승인 | 승인 | 자동 | 자동 |
| 파괴적 삭제 | 승인 | 승인 | 제안 후 확인 | 제안 후 확인 |

병합 후 100줄 초과 시 [원자적 문서 정책](./04-atomic-document-policy.md) 분할 정책 적용.
